{"version":3,"sources":["boxed_expression_editor/index.ts","boxed_expression_editor/api/DataType.ts","boxed_expression_editor/api/LogicType.ts","boxed_expression_editor/api/Table.ts","boxed_expression_editor/components/PopoverMenu/PopoverMenu.tsx","boxed_expression_editor/components/EditExpressionMenu/EditExpressionMenu.tsx","boxed_expression_editor/components/LiteralExpression/LiteralExpression.tsx","boxed_expression_editor/components/Table/EditableCell.tsx","boxed_expression_editor/components/Table/TableHandlerMenu.tsx","boxed_expression_editor/components/Table/Table.tsx","boxed_expression_editor/components/RelationExpression/RelationExpression.tsx","boxed_expression_editor/components/ContextExpression/ContextEntry.tsx","boxed_expression_editor/components/ContextExpression/ContextEntryCell.tsx","boxed_expression_editor/components/ContextExpression/ContextExpression.tsx","boxed_expression_editor/components/LogicTypeSelector/LogicTypeSelector.tsx","boxed_expression_editor/hooks/Hooks.ts","boxed_expression_editor/components/ExpressionContainer/ExpressionContainer.tsx","boxed_expression_editor/components/BoxedExpressionEditor/BoxedExpressionEditor.tsx","boxed_expression_editor/i18n/locales/en.ts","boxed_expression_editor/i18n/setup.ts","index.tsx","boxed_expression_editor/i18n/index.ts","boxed_expression_editor/api/index.ts"],"names":["DataType","LogicType","TableOperation","PopoverMenu","children","arrowPlacement","body","title","appendTo","Popover","data-ouia-component-id","className","position","distance","id","reference","headerContent","bodyContent","EditExpressionMenu","nameField","dataTypeField","selectedDataType","Undefined","selectedExpressionName","onExpressionUpdate","i18n","useBoxedExpressionEditorI18n","editExpression","name","dataType","useState","dataTypeSelectOpen","setDataTypeSelectOpen","setDataType","expressionName","setExpressionName","useEffect","onExpressionNameChange","useCallback","event","target","value","type","onDataTypeSelect","selection","getDataTypes","_","Object","values","key","SelectOption","onDataTypeFilter","e","input","RegExp","exception","filter","child","test","props","onDataTypeSelectToggle","isOpen","onChange","onBlur","placeholder","Select","ouiaId","variant","SelectVariant","typeahead","typeAheadAriaLabel","choose","onToggle","onSelect","onFilter","selections","hasInlineFilter","inlineFilterPlaceholderText","LiteralExpression","content","onUpdatingNameAndDataType","isHeadless","onUpdatingRecursiveExpression","width","expressionDataType","setExpressionDataType","literalExpressionContent","setLiteralExpressionContent","literalExpressionWidth","setLiteralExpressionWidth","expressionDefinition","logicType","window","beeApi","broadcastLiteralExpressionDefinition","onContentChange","updatedContent","getEditExpressionMenuArrowPlacement","document","querySelector","resizerHandler","useMemo","onResizeStop","data","size","renderElementWithResizeHandler","element","minWidth","height","minConstraints","axis","handle","renderLiteralExpressionHeader","getBodyContent","TextArea","defaultValue","aria-label","EditableCell","initialValue","index","row","column","onCellUpdate","React","setValue","TableHandlerMenu","handlerConfiguration","allowedOperations","onOperation","Menu","itemId","map","groupOperation","MenuGroup","group","label","items","operation","MenuList","MenuItem","isDisabled","NO_TABLE_CONTEXT_MENU_CLASS","Table","columnPrefix","editColumnLabel","onColumnsUpdate","onRowsUpdate","onRowAdding","defaultCell","rows","columns","NUMBER_OF_ROWS_COLUMN","tableRef","useRef","accessor","disableResizing","isCountColumn","hideFilter","tableColumns","setTableColumns","tableRows","setTableRows","showTableHandler","setShowTableHandler","tableHandlerTarget","setTableHandlerTarget","parseInt","toString","tableHandlerAllowedOperations","setTableHandlerAllowedOperations","lastSelectedColumnIndex","setLastSelectedColumnIndex","lastSelectedRowIndex","setLastSelectedRowIndex","insertBefore","elements","slice","insertAfter","deleteAt","updateColumnNameInRows","prevColumnName","newColumnName","prevTableCells","tableCells","assignedCellValue","onColumnNameOrDataTypeUpdate","columnIndex","prevTableColumns","updatedTableColumns","rowIndex","columnId","updatedTableCells","onRowUpdate","updatedRow","updatedRows","generateNextAvailableColumnName","lastIndex","candidateName","generateNextAvailableColumn","length","handlingOperation","tableOperation","ColumnInsertLeft","ColumnInsertRight","ColumnDelete","RowInsertAbove","prevTableRows","RowInsertBelow","RowDelete","defaultColumn","Cell","cellRef","contextMenuIsAvailable","targetIsContainedInCurrentTable","closest","current","contextMenuAvailableForTarget","classList","contains","tableInstance","useTable","getThProps","onContextMenu","handlerOnHeaderIsAvailable","disableHandlerOnHeader","preventDefault","getTdProps","useBlockLayout","useResizeColumns","buildTableHandler","hasNoPadding","showClose","isVisible","shouldClose","shouldOpen","showFunction","finishedResizing","state","columnResizing","isResizingColumn","columnWidths","updatedColumnWidth","updatedColumn","splice","renderCountColumn","Th","getHeaderProps","data-ouia-component-type","renderResizableColumn","canResize","getResizerProps","renderAdditiveRow","Tr","Td","role","TableComposable","getTableProps","ref","Thead","noWrap","headers","Tbody","getTableBodyProps","prepareRow","getRowProps","cells","cell","cellIndex","getCellProps","render","RelationExpression","relationProps","columnOperations","insertLeft","insertRight","delete","rowOperations","insertAbove","insertBelow","undefined","broadcastRelationExpressionDefinition","convertColumnsForTheTable","onSavingColumns","columnInstance","convertRowsForTheTable","tableRow","onSavingRows","push","editRelation","ContextEntry","expression","entryExpression","setEntryExpression","expressionChangedExternally","expressionContainerRef","getLogicTypeSelectorRef","onLogicTypeUpdating","previousSelectedExpression","onLogicTypeResetting","selectedExpression","getPlacementRef","ContextEntryCell","contextEntry","entryName","setEntryName","entryDataType","setEntryDataType","onEntryNameOrDataTypeUpdate","editContextEntry","DEFAULT_CONTEXT_ENTRY_NAME","DEFAULT_CONTEXT_ENTRY_DATA_TYPE","ContextExpression","contextEntries","result","setColumns","setRows","resultExpression","setResultExpression","expressionColumn","updatedDefinition","Context","broadcastContextExpressionDefinition","querySelectorAll","forEach","td","style","th","onUpdatingExpressionColumn","prevExpressionColumn","generateNextAvailableEntryName","LogicTypeSelector","isLogicTypeSelected","logicTypeSelected","setLogicTypeSelected","wrapperRef","xPos","setXPos","yPos","setYPos","contextMenuVisible","setContextMenuVisible","hideContextMenu","showContextMenu","pageX","pageY","addEventListener","removeEventListener","contextMenuRef","contextMenuXPos","contextMenuYPos","contextMenuVisibility","setContextMenuVisibility","useContextMenuHandler","renderExpression","Relation","DecisionTable","Function","Invocation","List","getLogicTypesWithoutUndefined","renderLogicTypeItems","SimpleListItem","getLogicSelectionArrowPlacement","onLogicTypeSelect","currentItem","currentItemProps","selectedLogicType","buildLogicSelectorMenu","selectLogicType","SimpleList","executeClearAction","buildContextMenu","top","left","Button","isSmall","ButtonVariant","primary","onClick","clear","selectExpression","ExpressionContainer","setSelectedExpression","updateExpressionNameAndDataType","updatedName","updatedDataType","updatedExpression","resetExpressionDefinition","BoxedExpressionEditor","defaults","boxedExpressionEditorI18nDefaults","dictionaries","boxedExpressionEditorDictionaries","initialLocale","navigator","language","ctx","BoxedExpressionEditorI18nContext","en","en_common","context","decisionTable","function","invocation","list","literalExpression","relation","locale","dictionary","Map","useContext","App","setUpdatedExpression","definition","JSON","stringify","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.6c7a6a20.chunk.js","sourcesContent":["/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *       http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from \"./components\";\nexport * from \"./api\";\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum DataType {\n  Undefined = \"<Undefined>\",\n  Any = \"Any\",\n  Boolean = \"boolean\",\n  Context = \"context\",\n  Date = \"date\",\n  DateTime = \"date and time\",\n  DateTimeDuration = \"days and time duration\",\n  Number = \"number\",\n  String = \"string\",\n  Time = \"time\",\n  YearsMonthsDuration = \"years and months duration\",\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum LogicType {\n  Undefined = \"<Undefined>\",\n  LiteralExpression = \"Literal expression\",\n  Context = \"Context\",\n  DecisionTable = \"Decision Table\",\n  Relation = \"Relation\",\n  Function = \"Function\",\n  Invocation = \"Invocation\",\n  List = \"List\",\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataType } from \"./DataType\";\n\n/** Table allowed operations */\nexport enum TableOperation {\n  ColumnInsertLeft,\n  ColumnInsertRight,\n  ColumnDelete,\n  RowInsertAbove,\n  RowInsertBelow,\n  RowDelete,\n}\n\nexport interface GroupOperations {\n  /** Name of the group (localized) */\n  group: string;\n  /** Collection of operations belonging to this group */\n  items: {\n    /** Name of the operation (localized) */\n    name: string;\n    /** Type of the operation */\n    type: TableOperation;\n  }[];\n}\n\nexport type TableHandlerConfiguration = GroupOperations[];\n\nexport type AllowedOperations = TableOperation[];\n\nexport type Row = string[];\n\nexport type Rows = Row[];\n\nexport interface Column {\n  /** Column name */\n  name: string;\n  /** Column data type */\n  dataType: DataType;\n  /** Column width */\n  width?: string | number;\n}\n\nexport type Columns = Column[];\n\nexport interface CellProps {\n  /** Cell's row properties */\n  row: { index: number };\n  /** Cell's column properties */\n  column: { id: string };\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { Popover } from \"@patternfly/react-core\";\nimport \"./PopoverMenu.css\";\n\nexport interface PopoverMenuProps {\n  /** Optional children element to be considered for triggering the popover */\n  children?: React.ReactElement;\n  /** Title of the popover menu */\n  title: string;\n  /** A function which returns the HTMLElement where the popover's arrow should be placed */\n  arrowPlacement?: () => HTMLElement;\n  /** The content of the popover itself */\n  body: React.ReactNode;\n  /** The node where to append the popover content */\n  appendTo?: HTMLElement | ((ref?: HTMLElement) => HTMLElement);\n}\n\nexport const PopoverMenu: React.FunctionComponent<PopoverMenuProps> = ({\n  children,\n  arrowPlacement,\n  body,\n  title,\n  appendTo,\n}: PopoverMenuProps) => {\n  return (\n    <Popover\n      data-ouia-component-id=\"expression-popover-menu\"\n      className=\"popover-menu-selector\"\n      position=\"bottom\"\n      distance={0}\n      id=\"menu-selector\"\n      reference={arrowPlacement}\n      appendTo={appendTo}\n      headerContent={\n        <div className=\"selector-menu-title\" data-ouia-component-id=\"expression-popover-menu-title\">\n          {title}\n        </div>\n      }\n      bodyContent={body}\n    >\n      {children}\n    </Popover>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./EditExpressionMenu.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { PopoverMenu } from \"../PopoverMenu\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { DataType, ExpressionProps } from \"../../api\";\nimport { Select, SelectOption, SelectVariant } from \"@patternfly/react-core\";\nimport * as _ from \"lodash\";\n\nexport interface EditExpressionMenuProps {\n  /** Optional children element to be considered for triggering the edit expression menu */\n  children?: React.ReactElement;\n  /** The node where to append the popover content */\n  appendTo?: HTMLElement | ((ref?: HTMLElement) => HTMLElement);\n  /** A function which returns the HTMLElement where the popover's arrow should be placed */\n  arrowPlacement?: () => HTMLElement;\n  /** The label for the field 'Name' */\n  nameField?: string;\n  /** The label for the field 'Data Type' */\n  dataTypeField?: string;\n  /** The title of the popover menu */\n  title?: string;\n  /** The pre-selected data type */\n  selectedDataType?: DataType;\n  /** The pre-selected expression name */\n  selectedExpressionName: string;\n  /** Function to be called when the expression gets updated, passing the most updated version of it */\n  onExpressionUpdate: (expression: ExpressionProps) => void;\n}\n\nexport const EditExpressionMenu: React.FunctionComponent<EditExpressionMenuProps> = ({\n  children,\n  appendTo,\n  arrowPlacement,\n  title,\n  nameField,\n  dataTypeField,\n  selectedDataType = DataType.Undefined,\n  selectedExpressionName,\n  onExpressionUpdate,\n}: EditExpressionMenuProps) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n  title = title ?? i18n.editExpression;\n  nameField = nameField ?? i18n.name;\n  dataTypeField = dataTypeField ?? i18n.dataType;\n\n  const [dataTypeSelectOpen, setDataTypeSelectOpen] = useState(false);\n  const [dataType, setDataType] = useState(selectedDataType);\n  const [expressionName, setExpressionName] = useState(selectedExpressionName);\n\n  useEffect(() => {\n    setExpressionName(selectedExpressionName);\n  }, [selectedExpressionName]);\n\n  useEffect(() => {\n    setDataType(selectedDataType);\n  }, [selectedDataType]);\n\n  const onExpressionNameChange = useCallback(\n    (event) => {\n      setExpressionName(event.target.value);\n      if (event.type === \"blur\") {\n        onExpressionUpdate({\n          name: event.target.value,\n          dataType,\n        });\n      }\n    },\n    [dataType, onExpressionUpdate]\n  );\n\n  const onDataTypeSelect = useCallback(\n    (event, selection) => {\n      setDataTypeSelectOpen(false);\n      setDataType(selection);\n      onExpressionUpdate({\n        name: expressionName,\n        dataType: selection,\n      });\n    },\n    [expressionName, onExpressionUpdate]\n  );\n\n  const getDataTypes = useCallback(() => {\n    return _.map(Object.values(DataType), (key) => (\n      <SelectOption key={key} value={key}>\n        {key}\n      </SelectOption>\n    ));\n  }, []);\n\n  const onDataTypeFilter = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      let input: RegExp;\n      try {\n        input = new RegExp(e.target.value, \"i\");\n      } catch (exception) {\n        return getDataTypes();\n      }\n      return e.target.value !== \"\" ? getDataTypes().filter((child) => input.test(child.props.value)) : getDataTypes();\n    },\n    [getDataTypes]\n  );\n\n  const onDataTypeSelectToggle = useCallback((isOpen) => setDataTypeSelectOpen(isOpen), []);\n\n  return (\n    <PopoverMenu\n      title={title}\n      arrowPlacement={arrowPlacement}\n      appendTo={appendTo}\n      body={\n        <div className=\"edit-expression-menu\">\n          <div className=\"expression-name\">\n            <label>{nameField}</label>\n            <input\n              type=\"text\"\n              id=\"expression-name\"\n              data-ouia-component-id=\"edit-expression-name\"\n              value={expressionName}\n              onChange={onExpressionNameChange}\n              onBlur={onExpressionNameChange}\n              className=\"form-control pf-c-form-control\"\n              placeholder=\"Expression Name\"\n            />\n          </div>\n          <div className=\"expression-data-type\">\n            <label>{dataTypeField}</label>\n            <Select\n              ouiaId=\"edit-expression-data-type\"\n              variant={SelectVariant.typeahead}\n              typeAheadAriaLabel={i18n.choose}\n              onToggle={onDataTypeSelectToggle}\n              onSelect={onDataTypeSelect}\n              onFilter={onDataTypeFilter}\n              isOpen={dataTypeSelectOpen}\n              selections={dataType}\n              hasInlineFilter\n              inlineFilterPlaceholderText={i18n.choose}\n            >\n              {getDataTypes()}\n            </Select>\n          </div>\n        </div>\n      }\n    >\n      {children}\n    </PopoverMenu>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./LiteralExpression.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { ExpressionProps, LiteralExpressionProps, LogicType } from \"../../api\";\nimport { TextArea } from \"@patternfly/react-core\";\nimport { EditExpressionMenu } from \"../EditExpressionMenu\";\nimport { ResizableBox } from \"react-resizable\";\n\nexport const LiteralExpression: React.FunctionComponent<LiteralExpressionProps> = ({\n  content,\n  dataType,\n  name,\n  onUpdatingNameAndDataType,\n  isHeadless = false,\n  onUpdatingRecursiveExpression,\n  width,\n}: LiteralExpressionProps) => {\n  const HEADER_WIDTH = 250;\n  const HEADER_HEIGHT = 40;\n  const BODY_WIDTH = 200;\n  const BODY_HEIGHT = 50;\n\n  const [expressionName, setExpressionName] = useState(name);\n  const [expressionDataType, setExpressionDataType] = useState(dataType);\n  const [literalExpressionContent, setLiteralExpressionContent] = useState(content);\n  const [literalExpressionWidth, setLiteralExpressionWidth] = useState(width || isHeadless ? BODY_WIDTH : HEADER_WIDTH);\n\n  useEffect(() => {\n    const expressionDefinition: LiteralExpressionProps = {\n      name: expressionName,\n      dataType: expressionDataType,\n      logicType: LogicType.LiteralExpression,\n      content: literalExpressionContent,\n      ...((isHeadless && literalExpressionWidth === BODY_WIDTH) ||\n      (!isHeadless && literalExpressionWidth === HEADER_WIDTH)\n        ? {}\n        : { width: literalExpressionWidth }),\n    };\n    isHeadless\n      ? onUpdatingRecursiveExpression?.(expressionDefinition)\n      : window.beeApi?.broadcastLiteralExpressionDefinition?.(expressionDefinition);\n  }, [\n    expressionName,\n    expressionDataType,\n    literalExpressionContent,\n    isHeadless,\n    onUpdatingRecursiveExpression,\n    literalExpressionWidth,\n  ]);\n\n  const onExpressionUpdate = useCallback(\n    ({ dataType, name }: ExpressionProps) => {\n      setExpressionName(name);\n      setExpressionDataType(dataType);\n      if (onUpdatingNameAndDataType) {\n        onUpdatingNameAndDataType(name, dataType);\n      }\n    },\n    [onUpdatingNameAndDataType]\n  );\n\n  const onContentChange = useCallback((event) => {\n    const updatedContent = event.target.value;\n    setLiteralExpressionContent(updatedContent);\n  }, []);\n\n  const getEditExpressionMenuArrowPlacement = useCallback(\n    () => document.querySelector(\".literal-expression-header\")! as HTMLElement,\n    []\n  );\n\n  const resizerHandler = useMemo(\n    () => (\n      <div className=\"pf-c-drawer\">\n        <div className=\"pf-c-drawer__splitter pf-m-vertical\">\n          <div className=\"pf-c-drawer__splitter-handle\" />\n        </div>\n      </div>\n    ),\n    []\n  );\n\n  const onResizeStop = useCallback((e, data) => setLiteralExpressionWidth(data.size.width), []);\n\n  const renderElementWithResizeHandler = useCallback(\n    (element, minWidth, height) => {\n      return (\n        <ResizableBox\n          width={literalExpressionWidth}\n          height={height}\n          minConstraints={[minWidth, height]}\n          axis=\"x\"\n          onResizeStop={onResizeStop}\n          handle={resizerHandler}\n        >\n          {element}\n        </ResizableBox>\n      );\n    },\n    [literalExpressionWidth, onResizeStop, resizerHandler]\n  );\n\n  const renderLiteralExpressionHeader = useMemo(() => {\n    return (\n      <div className=\"literal-expression-header\">\n        {renderElementWithResizeHandler(\n          <div className=\"expression-info\">\n            <p className=\"expression-name pf-u-text-truncate\">{expressionName}</p>\n            <p className=\"expression-data-type pf-u-text-truncate\">({expressionDataType})</p>\n          </div>,\n          HEADER_WIDTH,\n          HEADER_HEIGHT\n        )}\n      </div>\n    );\n  }, [expressionDataType, expressionName, renderElementWithResizeHandler]);\n\n  const getBodyContent = useMemo(\n    () => (\n      <TextArea\n        defaultValue={literalExpressionContent}\n        onBlur={onContentChange}\n        aria-label=\"literal-expression-content\"\n      />\n    ),\n    [literalExpressionContent, onContentChange]\n  );\n\n  return (\n    <div className=\"literal-expression\">\n      {!isHeadless ? renderLiteralExpressionHeader : null}\n      <div className={`literal-expression-body ${isHeadless ? \"headless-body\" : \"\"}`}>\n        {isHeadless ? renderElementWithResizeHandler(getBodyContent, BODY_WIDTH, BODY_HEIGHT) : getBodyContent}\n      </div>\n      <EditExpressionMenu\n        arrowPlacement={getEditExpressionMenuArrowPlacement}\n        selectedExpressionName={expressionName}\n        selectedDataType={expressionDataType}\n        onExpressionUpdate={onExpressionUpdate}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { ChangeEvent, useCallback, useEffect } from \"react\";\nimport { CellProps } from \"../../api\";\n\nexport interface EditableCellProps extends CellProps {\n  /** Cell's value */\n  value: string;\n  /** Function executed each time a cell gets updated */\n  onCellUpdate: (rowIndex: number, columnId: string, value: string) => void;\n}\n\nexport const EditableCell: React.FunctionComponent<EditableCellProps> = ({\n  value: initialValue,\n  row: { index },\n  column: { id },\n  onCellUpdate,\n}: EditableCellProps) => {\n  const [value, setValue] = React.useState(initialValue);\n\n  useEffect(() => {\n    setValue(initialValue);\n  }, [initialValue]);\n\n  const onChange = useCallback((e: ChangeEvent<HTMLTextAreaElement>) => {\n    setValue(e.target.value);\n  }, []);\n\n  const onBlur = useCallback(() => {\n    onCellUpdate(index, id, value);\n  }, [id, index, value, onCellUpdate]);\n\n  return <textarea value={value || \"\"} onChange={onChange} onBlur={onBlur} />;\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./TableHandlerMenu.css\";\nimport * as React from \"react\";\nimport { Menu, MenuGroup, MenuItem, MenuList } from \"@patternfly/react-core\";\nimport { AllowedOperations, TableHandlerConfiguration, TableOperation } from \"../../api\";\nimport * as _ from \"lodash\";\n\nexport interface TableHandlerProps {\n  /** Handler menu groups and items */\n  handlerConfiguration: TableHandlerConfiguration;\n  /** Dynamic Allowed operations */\n  allowedOperations: AllowedOperations;\n  /** Function to be executed when an operation gets selected */\n  onOperation: (operation: TableOperation) => void;\n}\n\nexport const TableHandlerMenu: React.FunctionComponent<TableHandlerProps> = ({\n  handlerConfiguration,\n  allowedOperations,\n  onOperation,\n}) => {\n  return (\n    <Menu\n      ouiaId=\"expression-table-handler-menu\"\n      className=\"table-handler-menu\"\n      onSelect={(event, itemId) => onOperation(itemId)}\n    >\n      {handlerConfiguration.map((groupOperation) => (\n        <MenuGroup\n          key={groupOperation.group}\n          label={groupOperation.group}\n          className={\n            _.every(groupOperation.items, (operation) => !_.includes(allowedOperations, operation.type))\n              ? \"no-allowed-actions-in-group\"\n              : \"\"\n          }\n        >\n          <MenuList>\n            {groupOperation.items.map((operation) => (\n              <MenuItem\n                data-ouia-component-id={\"expression-table-handler-menu-\" + operation.name}\n                key={operation.type}\n                itemId={operation.type}\n                isDisabled={!_.includes(allowedOperations, operation.type)}\n              >\n                {operation.name}\n              </MenuItem>\n            ))}\n          </MenuList>\n        </MenuGroup>\n      ))}\n    </Menu>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./Table.css\";\nimport {\n  Cell,\n  Column,\n  ColumnInstance,\n  ContextMenuEvent,\n  DataRecord,\n  Row,\n  useBlockLayout,\n  useResizeColumns,\n  useTable,\n} from \"react-table\";\nimport { TableComposable, Tbody, Td, Th, Thead, Tr } from \"@patternfly/react-table\";\nimport { EditExpressionMenu } from \"../EditExpressionMenu\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { EditableCell } from \"./EditableCell\";\nimport { CellProps, DataType, TableHandlerConfiguration, TableOperation } from \"../../api\";\nimport * as _ from \"lodash\";\nimport { Popover } from \"@patternfly/react-core\";\nimport { TableHandlerMenu } from \"./TableHandlerMenu\";\n\nexport interface TableProps {\n  /** Optional children element to be appended below the table content */\n  children?: React.ReactElement;\n  /** The prefix to be used for the column name */\n  columnPrefix?: string;\n  /** Optional label to be used for the edit popover that appears when clicking on column header */\n  editColumnLabel?: string;\n  /** Component to be used for rendering a cell */\n  defaultCell?: React.FunctionComponent<CellProps>;\n  /** Table's columns */\n  columns: Column[];\n  /** Table's cells */\n  rows: DataRecord[];\n  /** Function to be executed when columns are modified */\n  onColumnsUpdate: (columns: Column[]) => void;\n  /** Function to be executed when cells are modified */\n  onRowsUpdate: (rows: DataRecord[]) => void;\n  /** Function to be executed when adding a new row to the table */\n  onRowAdding?: () => DataRecord;\n  /** Custom configuration for the table handler */\n  handlerConfiguration: TableHandlerConfiguration;\n  /** True to have no header for this table */\n  isHeadless?: boolean;\n}\n\nexport const NO_TABLE_CONTEXT_MENU_CLASS = \"no-table-context-menu\";\n\nexport const Table: React.FunctionComponent<TableProps> = ({\n  children,\n  columnPrefix = \"column-\",\n  editColumnLabel,\n  onColumnsUpdate,\n  onRowsUpdate,\n  onRowAdding = () => ({}),\n  defaultCell = EditableCell,\n  rows,\n  columns,\n  handlerConfiguration,\n  isHeadless = false,\n}: TableProps) => {\n  const NUMBER_OF_ROWS_COLUMN = \"#\";\n\n  const tableRef = useRef<HTMLTableElement>(null);\n\n  const [tableColumns, setTableColumns] = useState([\n    {\n      label: NUMBER_OF_ROWS_COLUMN,\n      accessor: NUMBER_OF_ROWS_COLUMN,\n      width: 60,\n      disableResizing: true,\n      isCountColumn: true,\n      hideFilter: true,\n    },\n    ...columns,\n  ]);\n  const [tableRows, setTableRows] = useState(rows);\n  const [showTableHandler, setShowTableHandler] = useState(false);\n  const [tableHandlerTarget, setTableHandlerTarget] = useState(document.body);\n  const [tableHandlerAllowedOperations, setTableHandlerAllowedOperations] = useState(\n    _.values(TableOperation).map((operation) => parseInt(operation.toString()))\n  );\n  const [lastSelectedColumnIndex, setLastSelectedColumnIndex] = useState(-1);\n  const [lastSelectedRowIndex, setLastSelectedRowIndex] = useState(-1);\n\n  const insertBefore = <T extends unknown>(elements: T[], index: number, element: T) => {\n    return [...elements.slice(0, index), element, ...elements.slice(index)];\n  };\n\n  const insertAfter = <T extends unknown>(elements: T[], index: number, element: T) => {\n    return [...elements.slice(0, index + 1), element, ...elements.slice(index + 1)];\n  };\n\n  const deleteAt = <T extends unknown>(elements: T[], index: number) => {\n    return [...elements.slice(0, index), ...elements.slice(index + 1)];\n  };\n\n  const updateColumnNameInRows = useCallback(\n    (prevColumnName: string, newColumnName: string) =>\n      setTableRows((prevTableCells) => {\n        return _.map(prevTableCells, (tableCells) => {\n          const assignedCellValue = tableCells[prevColumnName]!;\n          delete tableCells[prevColumnName];\n          tableCells[newColumnName] = assignedCellValue;\n          return tableCells;\n        });\n      }),\n    []\n  );\n\n  const onColumnNameOrDataTypeUpdate = useCallback(\n    (columnIndex: number) => {\n      return ({ name = \"\", dataType = DataType.Undefined }) => {\n        const prevColumnName = (tableColumns[columnIndex] as ColumnInstance).accessor as string;\n        setTableColumns((prevTableColumns: ColumnInstance[]) => {\n          const updatedTableColumns = [...prevTableColumns];\n          updatedTableColumns[columnIndex].label = name;\n          updatedTableColumns[columnIndex].accessor = name;\n          updatedTableColumns[columnIndex].dataType = dataType;\n          return updatedTableColumns;\n        });\n        if (name !== prevColumnName) {\n          updateColumnNameInRows(prevColumnName, name);\n        }\n      };\n    },\n    [tableColumns, updateColumnNameInRows]\n  );\n\n  const onCellUpdate = useCallback((rowIndex: number, columnId: string, value: string) => {\n    setTableRows((prevTableCells) => {\n      const updatedTableCells = [...prevTableCells];\n      updatedTableCells[rowIndex][columnId] = value;\n      return updatedTableCells;\n    });\n  }, []);\n\n  const onRowUpdate = useCallback((rowIndex: number, updatedRow: DataRecord) => {\n    setTableRows((prevTableCells) => {\n      const updatedRows = [...prevTableCells];\n      updatedRows[rowIndex] = updatedRow;\n      return updatedRows;\n    });\n  }, []);\n\n  const generateNextAvailableColumnName: (lastIndex: number) => string = useCallback(\n    (lastIndex) => {\n      const candidateName = `${columnPrefix}${lastIndex}`;\n      const columnWithCandidateName = _.find(tableColumns, { accessor: candidateName });\n      return columnWithCandidateName ? generateNextAvailableColumnName(lastIndex + 1) : candidateName;\n    },\n    [columnPrefix, tableColumns]\n  );\n\n  const generateNextAvailableColumn = useCallback(\n    (columns: Column[]) => {\n      return {\n        accessor: generateNextAvailableColumnName(columns.length),\n        label: generateNextAvailableColumnName(columns.length),\n        dataType: DataType.Undefined,\n      };\n    },\n    [generateNextAvailableColumnName]\n  );\n\n  const handlingOperation = useCallback(\n    (tableOperation: TableOperation) => {\n      switch (tableOperation) {\n        case TableOperation.ColumnInsertLeft:\n          setTableColumns((prevTableColumns) =>\n            insertBefore(prevTableColumns, lastSelectedColumnIndex, generateNextAvailableColumn(prevTableColumns))\n          );\n          break;\n        case TableOperation.ColumnInsertRight:\n          setTableColumns((prevTableColumns) =>\n            insertAfter(prevTableColumns, lastSelectedColumnIndex, generateNextAvailableColumn(prevTableColumns))\n          );\n          break;\n        case TableOperation.ColumnDelete:\n          setTableColumns((prevTableColumns) => deleteAt(prevTableColumns, lastSelectedColumnIndex));\n          break;\n        case TableOperation.RowInsertAbove:\n          setTableRows((prevTableRows) => insertBefore(prevTableRows, lastSelectedRowIndex, onRowAdding()));\n          break;\n        case TableOperation.RowInsertBelow:\n          setTableRows((prevTableRows) => insertAfter(prevTableRows, lastSelectedRowIndex, onRowAdding()));\n          break;\n        case TableOperation.RowDelete:\n          setTableRows((prevTableRows) => deleteAt(prevTableRows, lastSelectedRowIndex));\n          break;\n      }\n      setShowTableHandler(false);\n    },\n    [generateNextAvailableColumn, lastSelectedColumnIndex, lastSelectedRowIndex, onRowAdding]\n  );\n\n  const defaultColumn = {\n    minWidth: 38,\n    width: 150,\n    Cell: useCallback(\n      (cellRef) => {\n        const column = cellRef.column as ColumnInstance;\n        return column.isCountColumn ? cellRef.value : defaultCell(cellRef);\n      },\n      [defaultCell]\n    ),\n  };\n\n  const contextMenuIsAvailable = (target: HTMLElement) => {\n    const targetIsContainedInCurrentTable = target.closest(\"table\") === tableRef.current;\n    const contextMenuAvailableForTarget = !target.classList.contains(NO_TABLE_CONTEXT_MENU_CLASS);\n    return targetIsContainedInCurrentTable && contextMenuAvailableForTarget;\n  };\n\n  const getThProps = (columnIndex: number) => ({\n    onContextMenu: (e: ContextMenuEvent) => {\n      const target = e.target as HTMLElement;\n      const handlerOnHeaderIsAvailable = !(tableColumns[columnIndex] as ColumnInstance).disableHandlerOnHeader;\n      if (contextMenuIsAvailable(target) && handlerOnHeaderIsAvailable) {\n        e.preventDefault();\n        setTableHandlerAllowedOperations([\n          TableOperation.ColumnInsertLeft,\n          TableOperation.ColumnInsertRight,\n          ...(tableColumns.length > 2 && columnIndex > 0 ? [TableOperation.ColumnDelete] : []),\n        ]);\n        setTableHandlerTarget(target);\n        setShowTableHandler(true);\n        setLastSelectedColumnIndex(columnIndex);\n      }\n    },\n  });\n\n  const getTdProps = (columnIndex: number, rowIndex: number) => ({\n    onContextMenu: (e: ContextMenuEvent) => {\n      const target = e.target as HTMLElement;\n      if (contextMenuIsAvailable(target)) {\n        e.preventDefault();\n        setTableHandlerAllowedOperations([\n          TableOperation.ColumnInsertLeft,\n          TableOperation.ColumnInsertRight,\n          ...(tableColumns.length > 2 && columnIndex > 0 ? [TableOperation.ColumnDelete] : []),\n          TableOperation.RowInsertAbove,\n          TableOperation.RowInsertBelow,\n          ...(tableRows.length > 1 ? [TableOperation.RowDelete] : []),\n        ]);\n        setTableHandlerTarget(target);\n        setShowTableHandler(true);\n        setLastSelectedColumnIndex(columnIndex);\n        setLastSelectedRowIndex(rowIndex);\n      }\n    },\n  });\n\n  const tableInstance = useTable(\n    {\n      columns: tableColumns,\n      data: tableRows,\n      defaultColumn,\n      onCellUpdate,\n      onRowUpdate,\n      getThProps,\n      getTdProps,\n    },\n    useBlockLayout,\n    useResizeColumns\n  );\n\n  const buildTableHandler = useMemo(\n    () => (\n      <Popover\n        className=\"table-handler\"\n        hasNoPadding\n        showClose={false}\n        distance={5}\n        position={\"right\"}\n        isVisible={showTableHandler}\n        shouldClose={() => setShowTableHandler(false)}\n        shouldOpen={(showFunction) => showFunction?.()}\n        reference={() => tableHandlerTarget}\n        bodyContent={\n          <TableHandlerMenu\n            handlerConfiguration={handlerConfiguration}\n            allowedOperations={tableHandlerAllowedOperations}\n            onOperation={handlingOperation}\n          />\n        }\n      />\n    ),\n    [showTableHandler, handlerConfiguration, tableHandlerAllowedOperations, handlingOperation, tableHandlerTarget]\n  );\n\n  useEffect(() => {\n    onColumnsUpdate(tableColumns.slice(1)); //Removing \"# of rows\" column\n  }, [onColumnsUpdate, tableColumns]);\n\n  useEffect(() => {\n    onRowsUpdate(tableRows);\n  }, [onRowsUpdate, tableRows]);\n\n  const finishedResizing =\n    tableInstance.state.columnResizing.isResizingColumn === null &&\n    !_.isEmpty(tableInstance.state.columnResizing.columnWidths);\n  useEffect(() => {\n    setTableColumns((prevTableColumns) => {\n      _.forEach(tableInstance.state.columnResizing.columnWidths, (updatedColumnWidth, accessor) => {\n        const columnIndex = _.findIndex(prevTableColumns, { accessor });\n        const updatedColumn = { ...prevTableColumns[columnIndex] };\n        updatedColumn.width = updatedColumnWidth;\n        prevTableColumns.splice(columnIndex, 1, updatedColumn);\n      });\n      return [...prevTableColumns];\n    });\n    // Need to consider a change only when resizing is finished (no other dependencies to consider for this useEffect)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [finishedResizing]);\n\n  const renderCountColumn = useCallback(\n    (column: ColumnInstance, columnIndex: number) => (\n      <Th {...column.getHeaderProps()} className=\"fixed-column\" key={columnIndex}>\n        <div className=\"header-cell\" data-ouia-component-type=\"expression-column-header\">\n          {column.label}\n        </div>\n      </Th>\n    ),\n    []\n  );\n\n  const renderResizableColumn = useCallback(\n    (column: ColumnInstance, columnIndex: number) => (\n      <EditExpressionMenu\n        title={editColumnLabel}\n        selectedExpressionName={column.label}\n        selectedDataType={column.dataType}\n        onExpressionUpdate={onColumnNameOrDataTypeUpdate(columnIndex)}\n        key={columnIndex}\n      >\n        <Th\n          {...column.getHeaderProps()}\n          {...tableInstance.getThProps(columnIndex)}\n          className=\"resizable-column\"\n          key={columnIndex}\n        >\n          <div className=\"header-cell\" data-ouia-component-type=\"expression-column-header\">\n            <div>\n              <p className=\"pf-u-text-truncate\">{column.label}</p>\n              <p className=\"pf-u-text-truncate data-type\">({column.dataType})</p>\n            </div>\n            <div\n              className={`pf-c-drawer ${!column.canResize ? \"resizer-disabled\" : \"\"}`}\n              {...(column.canResize ? column.getResizerProps() : {})}\n            >\n              <div className=\"pf-c-drawer__splitter pf-m-vertical\">\n                <div className=\"pf-c-drawer__splitter-handle\" />\n              </div>\n            </div>\n          </div>\n        </Th>\n      </EditExpressionMenu>\n    ),\n    [editColumnLabel, onColumnNameOrDataTypeUpdate, tableInstance]\n  );\n\n  const renderAdditiveRow = useMemo(() => {\n    return (\n      <Tr className=\"table-row additive-row\">\n        <Td role=\"cell\" className=\"empty-cell\">\n          <br />\n        </Td>\n        <Td role=\"cell\" className=\"row-remainder-content\">\n          {children}\n        </Td>\n      </Tr>\n    );\n  }, [children]);\n\n  return (\n    <div className=\"table-component\">\n      <TableComposable variant=\"compact\" {...tableInstance.getTableProps()} ref={tableRef}>\n        <Thead noWrap className={isHeadless ? \"headless-table\" : \"\"}>\n          <tr>\n            {tableInstance.headers.map((column: ColumnInstance, columnIndex: number) =>\n              column.isCountColumn ? renderCountColumn(column, columnIndex) : renderResizableColumn(column, columnIndex)\n            )}\n          </tr>\n        </Thead>\n\n        <Tbody {...tableInstance.getTableBodyProps()}>\n          {tableInstance.rows.map((row: Row, rowIndex: number) => {\n            tableInstance.prepareRow(row);\n            return (\n              <Tr className=\"table-row\" {...row.getRowProps()} key={rowIndex} ouiaId={\"expression-row-\" + rowIndex}>\n                {row.cells.map((cell: Cell, cellIndex: number) => (\n                  <Td\n                    {...cell.getCellProps()}\n                    {...tableInstance.getTdProps(cellIndex, rowIndex)}\n                    key={cellIndex}\n                    data-ouia-component-id={\"expression-column-\" + cellIndex}\n                    className={cellIndex === 0 ? \"counter-cell\" : \"data-cell\"}\n                  >\n                    {cellIndex === 0 ? rowIndex + 1 : cell.render(\"Cell\")}\n                  </Td>\n                ))}\n              </Tr>\n            );\n          })}\n          {children ? renderAdditiveRow : null}\n        </Tbody>\n      </TableComposable>\n      {showTableHandler ? buildTableHandler : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport \"@patternfly/patternfly/utilities/Text/text.css\";\nimport { DataType, RelationProps, TableOperation } from \"../../api\";\nimport { Table } from \"../Table\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport * as _ from \"lodash\";\nimport { Column, ColumnInstance, DataRecord } from \"react-table\";\n\nexport const RelationExpression: React.FunctionComponent<RelationProps> = (relationProps: RelationProps) => {\n  const FIRST_COLUMN_NAME = \"column-1\";\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const handlerConfiguration = [\n    {\n      group: i18n.columns,\n      items: [\n        { name: i18n.columnOperations.insertLeft, type: TableOperation.ColumnInsertLeft },\n        { name: i18n.columnOperations.insertRight, type: TableOperation.ColumnInsertRight },\n        { name: i18n.columnOperations.delete, type: TableOperation.ColumnDelete },\n      ],\n    },\n    {\n      group: i18n.rows,\n      items: [\n        { name: i18n.rowOperations.insertAbove, type: TableOperation.RowInsertAbove },\n        { name: i18n.rowOperations.insertBelow, type: TableOperation.RowInsertBelow },\n        { name: i18n.rowOperations.delete, type: TableOperation.RowDelete },\n      ],\n    },\n  ];\n\n  const [tableColumns, setTableColumns] = useState(\n    relationProps.columns === undefined\n      ? [{ name: FIRST_COLUMN_NAME, dataType: DataType.Undefined }]\n      : relationProps.columns\n  );\n\n  const [tableRows, setTableRows] = useState(relationProps.rows === undefined ? [[]] : relationProps.rows);\n\n  useEffect(() => {\n    const expressionDefinition = {\n      ...relationProps,\n      columns: tableColumns,\n      rows: tableRows,\n    };\n    relationProps.isHeadless\n      ? relationProps.onUpdatingRecursiveExpression?.(expressionDefinition)\n      : window.beeApi?.broadcastRelationExpressionDefinition?.(expressionDefinition);\n  }, [relationProps, tableColumns, tableRows]);\n\n  const convertColumnsForTheTable = useCallback(\n    () =>\n      _.map(\n        tableColumns,\n        (column) =>\n          ({\n            label: column.name,\n            accessor: column.name,\n            dataType: column.dataType,\n            ...(column.width ? { width: column.width } : {}),\n          } as Column)\n      ),\n    [tableColumns]\n  );\n\n  const onSavingColumns = useCallback(\n    (columns) =>\n      setTableColumns(\n        _.map(columns, (columnInstance: ColumnInstance) => ({\n          name: columnInstance.accessor,\n          dataType: columnInstance.dataType,\n          width: columnInstance.width,\n        }))\n      ),\n    []\n  );\n\n  const convertRowsForTheTable = useCallback(\n    () =>\n      _.map(tableRows, (row) =>\n        _.reduce(\n          tableColumns,\n          (tableRow: DataRecord, column, columnIndex) => {\n            tableRow[column.name] = row[columnIndex] || \"\";\n            return tableRow;\n          },\n          {}\n        )\n      ),\n    [tableColumns, tableRows]\n  );\n\n  const onSavingRows = useCallback(\n    (rows) =>\n      setTableRows(\n        _.map(rows, (tableRow: DataRecord) =>\n          _.reduce(\n            tableColumns,\n            (row: string[], column) => {\n              row.push((tableRow[column.name]! as string) || \"\");\n              return row;\n            },\n            []\n          )\n        )\n      ),\n    [tableColumns]\n  );\n\n  return (\n    <div className=\"relation-expression\">\n      <Table\n        columnPrefix=\"column-\"\n        editColumnLabel={i18n.editRelation}\n        columns={convertColumnsForTheTable()}\n        rows={convertRowsForTheTable()}\n        onColumnsUpdate={onSavingColumns}\n        onRowsUpdate={onSavingRows}\n        handlerConfiguration={handlerConfiguration}\n      />\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./ContextEntry.css\";\nimport { ExpressionProps, LogicType } from \"../../api\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { LogicTypeSelector } from \"../LogicTypeSelector\";\n\nexport interface ContextResultProps {\n  /** Children element to be used for entry info */\n  children?: React.ReactElement;\n  /** The expression wrapped by the entry */\n  expression: ExpressionProps;\n  /** Function invoked when updating expression */\n  onUpdatingRecursiveExpression: (expression: ExpressionProps) => void;\n}\n\nexport const ContextEntry: React.FunctionComponent<ContextResultProps> = ({\n  children,\n  expression,\n  onUpdatingRecursiveExpression,\n}) => {\n  const [entryExpression, setEntryExpression] = useState(expression);\n\n  const expressionChangedExternally = expression.logicType === undefined;\n\n  useEffect(() => {\n    setEntryExpression(expression);\n    // Every time, for an expression, its logic type is undefined, it means that corresponding entry has been just added\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [expressionChangedExternally]);\n\n  useEffect(() => {\n    onUpdatingRecursiveExpression(entryExpression);\n  }, [onUpdatingRecursiveExpression, entryExpression]);\n\n  const expressionContainerRef = useRef<HTMLDivElement>(null);\n\n  const getLogicTypeSelectorRef = useCallback(() => {\n    return expressionContainerRef.current!;\n  }, []);\n\n  const onLogicTypeUpdating = useCallback((logicType) => {\n    setEntryExpression((previousSelectedExpression: ExpressionProps) => ({\n      ...previousSelectedExpression,\n      logicType: logicType,\n    }));\n  }, []);\n\n  const onLogicTypeResetting = useCallback(() => {\n    setEntryExpression((previousSelectedExpression: ExpressionProps) => {\n      return {\n        name: previousSelectedExpression.name,\n        dataType: previousSelectedExpression.dataType,\n        logicType: LogicType.Undefined,\n      };\n    });\n  }, []);\n\n  return (\n    <div className=\"context-entry\">\n      <div className=\"entry-info\">{children}</div>\n\n      <div className=\"entry-expression\" ref={expressionContainerRef}>\n        <LogicTypeSelector\n          isHeadless={true}\n          onUpdatingRecursiveExpression={onUpdatingRecursiveExpression}\n          selectedExpression={entryExpression}\n          onLogicTypeUpdating={onLogicTypeUpdating}\n          onLogicTypeResetting={onLogicTypeResetting}\n          getPlacementRef={getLogicTypeSelectorRef}\n        />\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./ContextEntryCell.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { CellProps, ContextEntries, ExpressionProps } from \"../../api\";\nimport { EditExpressionMenu } from \"../EditExpressionMenu\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { DataRecord } from \"react-table\";\nimport { ContextEntry } from \"./ContextEntry\";\n\nexport interface ContextEntryProps extends CellProps {\n  data: ContextEntries;\n  onRowUpdate: (rowIndex: number, updatedRow: DataRecord) => void;\n}\n\nexport const ContextEntryCell: React.FunctionComponent<ContextEntryProps> = ({ data, row: { index }, onRowUpdate }) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const contextEntry = data[index];\n\n  const [entryName, setEntryName] = useState(contextEntry.name);\n\n  const [entryDataType, setEntryDataType] = useState(contextEntry.dataType);\n\n  const [entryExpression, setEntryExpression] = useState(contextEntry.expression);\n\n  useEffect(() => {\n    setEntryName(contextEntry.name);\n  }, [contextEntry.name]);\n\n  useEffect(() => {\n    setEntryDataType(contextEntry.dataType);\n  }, [contextEntry.dataType]);\n\n  const expressionChangedExternally = contextEntry.expression.logicType === undefined;\n  useEffect(() => {\n    setEntryExpression(contextEntry.expression);\n    // Every time, for an expression, its logic type is undefined, it means that corresponding entry has been just added\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [expressionChangedExternally]);\n\n  useEffect(() => {\n    onRowUpdate(index, { ...contextEntry, expression: entryExpression });\n    // Purpose is to update the row every time the expression wrapped in the entry changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [entryExpression]);\n\n  const onEntryNameOrDataTypeUpdate = useCallback(\n    ({ name, dataType }) => {\n      setEntryName(name);\n      setEntryDataType(dataType);\n      onRowUpdate(index, { ...contextEntry, name, dataType });\n    },\n    [contextEntry, index, onRowUpdate]\n  );\n\n  const onUpdatingRecursiveExpression = useCallback((expression: ExpressionProps) => {\n    setEntryExpression(expression);\n  }, []);\n\n  return (\n    <div className=\"context-entry-cell\">\n      <ContextEntry expression={entryExpression} onUpdatingRecursiveExpression={onUpdatingRecursiveExpression}>\n        <EditExpressionMenu\n          title={i18n.editContextEntry}\n          selectedExpressionName={entryName}\n          selectedDataType={entryDataType}\n          onExpressionUpdate={onEntryNameOrDataTypeUpdate}\n        >\n          <div className=\"entry-definition\">\n            <p className=\"entry-name pf-u-text-truncate\" title={entryName}>\n              {entryName}\n            </p>\n            <p className=\"entry-data-type pf-u-text-truncate\" title={entryDataType}>\n              ({entryDataType})\n            </p>\n          </div>\n        </EditExpressionMenu>\n      </ContextEntry>\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./ContextExpression.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport {\n  ContextEntries,\n  ContextProps,\n  DataType,\n  ExpressionProps,\n  LogicType,\n  TableHandlerConfiguration,\n  TableOperation,\n} from \"../../api\";\nimport { Table } from \"../Table\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { ColumnInstance, DataRecord } from \"react-table\";\nimport { ContextEntryCell } from \"./ContextEntryCell\";\nimport * as _ from \"lodash\";\nimport { ContextEntry } from \"./ContextEntry\";\n\nconst DEFAULT_CONTEXT_ENTRY_NAME = \"ContextEntry-1\";\nconst DEFAULT_CONTEXT_ENTRY_DATA_TYPE = DataType.Undefined;\n\nexport const ContextExpression: React.FunctionComponent<ContextProps> = ({\n  name = DEFAULT_CONTEXT_ENTRY_NAME,\n  dataType = DEFAULT_CONTEXT_ENTRY_DATA_TYPE,\n  onUpdatingNameAndDataType,\n  contextEntries = [\n    { name: DEFAULT_CONTEXT_ENTRY_NAME, dataType: DEFAULT_CONTEXT_ENTRY_DATA_TYPE, expression: {} } as DataRecord,\n  ],\n  result = {} as ExpressionProps,\n  isHeadless = false,\n  onUpdatingRecursiveExpression,\n}) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const handlerConfiguration: TableHandlerConfiguration = [\n    {\n      group: i18n.contextEntry,\n      items: [\n        { name: i18n.rowOperations.insertAbove, type: TableOperation.RowInsertAbove },\n        { name: i18n.rowOperations.insertBelow, type: TableOperation.RowInsertBelow },\n        { name: i18n.rowOperations.delete, type: TableOperation.RowDelete },\n      ],\n    },\n  ];\n\n  const [columns, setColumns] = useState([\n    {\n      label: name,\n      accessor: name,\n      dataType,\n      disableHandlerOnHeader: true,\n      disableResizing: true,\n    },\n  ]);\n\n  const [rows, setRows] = useState(contextEntries);\n\n  const [resultExpression, setResultExpression] = useState(result);\n\n  useEffect(() => {\n    const expressionColumn = columns[0];\n    const updatedDefinition: ContextProps = {\n      logicType: LogicType.Context,\n      name: expressionColumn.accessor,\n      dataType: expressionColumn.dataType,\n      contextEntries: rows as ContextEntries,\n      result: resultExpression,\n    };\n    isHeadless\n      ? onUpdatingRecursiveExpression?.(updatedDefinition)\n      : window.beeApi?.broadcastContextExpressionDefinition?.(updatedDefinition);\n  }, [columns, isHeadless, onUpdatingRecursiveExpression, rows, resultExpression]);\n\n  /**\n   * Every time the ContextExpression component gets re-rendered, automatically calculating table cells width to fit the entire content\n   */\n  useEffect(() => {\n    document\n      .querySelectorAll(\".context-expression > .table-component > table > tbody > tr > td.data-cell\")\n      .forEach((td: HTMLElement) => (td.style.width = \"100%\"));\n    document\n      .querySelectorAll(\".context-expression > .table-component > table > tbody > tr.table-row\")\n      .forEach((td: HTMLElement) => (td.style.width = \"100%\"));\n    document\n      .querySelectorAll(\".context-expression > .table-component > table > thead > tr > th.resizable-column\")\n      .forEach((th: HTMLElement) => (th.style.width = \"calc((100% - 60px)\"));\n  });\n\n  const onUpdatingExpressionColumn = useCallback(\n    ([expressionColumn]: [ColumnInstance]) => {\n      onUpdatingNameAndDataType?.(expressionColumn.label, expressionColumn.dataType);\n      setColumns(([prevExpressionColumn]) => [\n        {\n          ...prevExpressionColumn,\n          label: expressionColumn.label,\n          accessor: expressionColumn.accessor,\n          dataType: expressionColumn.dataType,\n          width: expressionColumn.width as number,\n        },\n      ]);\n    },\n    [onUpdatingNameAndDataType]\n  );\n\n  const generateNextAvailableEntryName: (lastIndex: number) => string = useCallback(\n    (lastIndex) => {\n      const candidateName = `ContextEntry-${lastIndex}`;\n      const entryWithCandidateName = _.find(rows, { name: candidateName });\n      return entryWithCandidateName ? generateNextAvailableEntryName(lastIndex + 1) : candidateName;\n    },\n    [rows]\n  );\n\n  const onRowAdding = useCallback(\n    () => ({\n      name: generateNextAvailableEntryName(rows.length),\n      dataType: DataType.Undefined,\n      expression: {},\n    }),\n    [generateNextAvailableEntryName, rows.length]\n  );\n\n  return (\n    <div className=\"context-expression\">\n      <Table\n        isHeadless={isHeadless}\n        defaultCell={ContextEntryCell}\n        columns={columns}\n        rows={rows as DataRecord[]}\n        onColumnsUpdate={onUpdatingExpressionColumn}\n        onRowAdding={onRowAdding}\n        onRowsUpdate={setRows}\n        handlerConfiguration={handlerConfiguration}\n      >\n        <ContextEntry expression={resultExpression} onUpdatingRecursiveExpression={setResultExpression}>\n          <div className=\"context-result\">{`<result>`}</div>\n        </ContextEntry>\n      </Table>\n    </div>\n  );\n};\n","/*\n * Copyright 2021 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./LogicTypeSelector.css\";\nimport * as React from \"react\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { ContextProps, DataType, ExpressionProps, LiteralExpressionProps, LogicType, RelationProps } from \"../../api\";\nimport { LiteralExpression } from \"../LiteralExpression\";\nimport { RelationExpression } from \"../RelationExpression\";\nimport { ContextExpression } from \"../ContextExpression\";\nimport { useBoxedExpressionEditorI18n } from \"../../i18n\";\nimport { PopoverMenu } from \"../PopoverMenu\";\nimport { Button, ButtonVariant, SimpleList, SimpleListItem, SimpleListItemProps } from \"@patternfly/react-core\";\nimport * as _ from \"lodash\";\nimport { useContextMenuHandler } from \"../../hooks\";\nimport { NO_TABLE_CONTEXT_MENU_CLASS } from \"../Table\";\n\nexport interface LogicTypeSelectorProps {\n  /** Expression properties */\n  selectedExpression: ExpressionProps;\n  /** Function to be invoked when logic type changes */\n  onLogicTypeUpdating: (logicType: LogicType) => void;\n  /** Function to be invoked when logic type is reset */\n  onLogicTypeResetting: () => void;\n  /** Function to be invoked to update expression's name and datatype */\n  onUpdatingNameAndDataType?: (updatedName: string, updatedDataType: DataType) => void;\n  /** Function to be invoked to retrieve the DOM reference to be used for selector placement */\n  getPlacementRef: () => HTMLDivElement;\n  /** True to have no header for this specific expression component, used in a recursive expression */\n  isHeadless?: boolean;\n  /** When a component is headless, it will call this function to pass its most updated expression definition */\n  onUpdatingRecursiveExpression?: (expression: ExpressionProps) => void;\n}\n\nexport const LogicTypeSelector: React.FunctionComponent<LogicTypeSelectorProps> = ({\n  selectedExpression,\n  onLogicTypeUpdating,\n  onLogicTypeResetting,\n  onUpdatingNameAndDataType,\n  getPlacementRef,\n  isHeadless = false,\n  onUpdatingRecursiveExpression,\n}) => {\n  const { i18n } = useBoxedExpressionEditorI18n();\n\n  const expression = _.extend(selectedExpression, {\n    isHeadless,\n    onUpdatingNameAndDataType,\n    onUpdatingRecursiveExpression,\n  });\n\n  const isLogicTypeSelected = (logicType?: LogicType) => !_.isEmpty(logicType) && logicType !== LogicType.Undefined;\n\n  const [logicTypeSelected, setLogicTypeSelected] = useState(isLogicTypeSelected(expression.logicType));\n\n  useEffect(() => {\n    setLogicTypeSelected(isLogicTypeSelected(selectedExpression.logicType));\n  }, [selectedExpression.logicType]);\n\n  const {\n    contextMenuRef,\n    contextMenuXPos,\n    contextMenuYPos,\n    contextMenuVisibility,\n    setContextMenuVisibility,\n  } = useContextMenuHandler();\n\n  const renderExpression = useMemo(() => {\n    switch (expression.logicType) {\n      case LogicType.LiteralExpression:\n        return <LiteralExpression {...(expression as LiteralExpressionProps)} />;\n      case LogicType.Relation:\n        return <RelationExpression {...(expression as RelationProps)} />;\n      case LogicType.Context:\n        return <ContextExpression {...(expression as ContextProps)} />;\n      case LogicType.DecisionTable:\n      case LogicType.Function:\n      case LogicType.Invocation:\n      case LogicType.List:\n      default:\n        return expression.logicType;\n    }\n    // logicType is enough for deciding when to re-execute this function\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [expression.logicType]);\n\n  const getLogicTypesWithoutUndefined = useCallback(\n    () => Object.values(LogicType).filter((logicType) => logicType !== LogicType.Undefined),\n    []\n  );\n\n  const renderLogicTypeItems = useCallback(\n    () => _.map(getLogicTypesWithoutUndefined(), (key) => <SimpleListItem key={key}>{key}</SimpleListItem>),\n    [getLogicTypesWithoutUndefined]\n  );\n\n  const getLogicSelectionArrowPlacement = useCallback(() => getPlacementRef() as HTMLElement, [getPlacementRef]);\n\n  const onLogicTypeSelect = useCallback(\n    (currentItem: React.RefObject<HTMLButtonElement>, currentItemProps: SimpleListItemProps) => {\n      setLogicTypeSelected(true);\n      const selectedLogicType = currentItemProps.children as LogicType;\n      onLogicTypeUpdating(selectedLogicType);\n    },\n    [onLogicTypeUpdating]\n  );\n\n  const buildLogicSelectorMenu = useCallback(\n    () => (\n      <PopoverMenu\n        title={i18n.selectLogicType}\n        arrowPlacement={getLogicSelectionArrowPlacement}\n        body={<SimpleList onSelect={onLogicTypeSelect}>{renderLogicTypeItems()}</SimpleList>}\n      />\n    ),\n    [i18n.selectLogicType, getLogicSelectionArrowPlacement, onLogicTypeSelect, renderLogicTypeItems]\n  );\n\n  const executeClearAction = useCallback(() => {\n    setLogicTypeSelected(false);\n    setContextMenuVisibility(false);\n    onLogicTypeResetting();\n  }, [onLogicTypeResetting, setContextMenuVisibility]);\n\n  const buildContextMenu = useCallback(\n    () => (\n      <div\n        className=\"context-menu-container\"\n        style={{\n          top: contextMenuYPos,\n          left: contextMenuXPos,\n        }}\n      >\n        <Button\n          isDisabled={!logicTypeSelected}\n          isSmall={true}\n          variant={ButtonVariant.primary}\n          onClick={executeClearAction}\n        >\n          {i18n.clear}\n        </Button>\n      </div>\n    ),\n    [logicTypeSelected, contextMenuXPos, contextMenuYPos, executeClearAction, i18n.clear]\n  );\n\n  return (\n    <div\n      className={`logic-type-selector ${NO_TABLE_CONTEXT_MENU_CLASS} ${\n        logicTypeSelected ? \"logic-type-selected\" : \"logic-type-not-present\"\n      }`}\n      ref={contextMenuRef}\n    >\n      {logicTypeSelected ? renderExpression : i18n.selectExpression}\n      {!logicTypeSelected ? buildLogicSelectorMenu() : null}\n      {contextMenuVisibility ? buildContextMenu() : null}\n    </div>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RefObject, useCallback, useEffect, useRef, useState } from \"react\";\n\nexport function useContextMenuHandler(): {\n  contextMenuRef: RefObject<HTMLDivElement>;\n  contextMenuXPos: string;\n  contextMenuYPos: string;\n  contextMenuVisibility: boolean;\n  setContextMenuVisibility: (value: ((prevState: boolean) => boolean) | boolean) => void;\n} {\n  const wrapperRef = useRef<HTMLDivElement>(null);\n\n  const [xPos, setXPos] = useState(\"0px\");\n  const [yPos, setYPos] = useState(\"0px\");\n  const [contextMenuVisible, setContextMenuVisible] = useState(false);\n\n  const hideContextMenu = useCallback(() => {\n    contextMenuVisible && setContextMenuVisible(false);\n  }, [contextMenuVisible]);\n\n  const showContextMenu = useCallback(\n    (event: MouseEvent) => {\n      if (wrapperRef.current && wrapperRef.current === event.target) {\n        event.preventDefault();\n        setXPos(`${event.pageX}px`);\n        setYPos(`${event.pageY}px`);\n        setContextMenuVisible(true);\n      }\n    },\n    [setXPos, setYPos]\n  );\n\n  useEffect(() => {\n    document.addEventListener(\"click\", hideContextMenu);\n    document.addEventListener(\"contextmenu\", hideContextMenu);\n    document.addEventListener(\"contextmenu\", showContextMenu);\n    return () => {\n      document.removeEventListener(\"click\", hideContextMenu);\n      document.removeEventListener(\"contextmenu\", hideContextMenu);\n      document.removeEventListener(\"contextmenu\", showContextMenu);\n    };\n  });\n\n  return {\n    contextMenuRef: wrapperRef,\n    contextMenuXPos: xPos,\n    contextMenuYPos: yPos,\n    contextMenuVisibility: contextMenuVisible,\n    setContextMenuVisibility: setContextMenuVisible,\n  };\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useCallback, useRef, useState } from \"react\";\nimport \"./ExpressionContainer.css\";\nimport { ExpressionProps, LogicType } from \"../../api\";\nimport { LogicTypeSelector } from \"../LogicTypeSelector\";\n\nexport interface ExpressionContainerProps {\n  /** Expression properties */\n  selectedExpression: ExpressionProps;\n}\n\nexport const ExpressionContainer: ({ selectedExpression }: ExpressionContainerProps) => JSX.Element = (\n  props: ExpressionContainerProps\n) => {\n  const expressionContainerRef = useRef<HTMLDivElement>(null);\n\n  const [selectedExpression, setSelectedExpression] = useState(props.selectedExpression);\n\n  const updateExpressionNameAndDataType = useCallback((updatedName, updatedDataType) => {\n    setSelectedExpression((previousSelectedExpression: ExpressionProps) => ({\n      ...previousSelectedExpression,\n      name: updatedName,\n      dataType: updatedDataType,\n    }));\n  }, []);\n\n  const onLogicTypeUpdating = useCallback((logicType) => {\n    setSelectedExpression((previousSelectedExpression: ExpressionProps) => ({\n      ...previousSelectedExpression,\n      logicType: logicType,\n    }));\n  }, []);\n\n  const onLogicTypeResetting = useCallback(() => {\n    setSelectedExpression((previousSelectedExpression: ExpressionProps) => {\n      const updatedExpression = {\n        name: previousSelectedExpression.name,\n        dataType: previousSelectedExpression.dataType,\n        logicType: LogicType.Undefined,\n      };\n      window.beeApi?.resetExpressionDefinition?.(updatedExpression);\n      return updatedExpression;\n    });\n  }, []);\n\n  const getLogicTypeSelectorRef = useCallback(() => {\n    return expressionContainerRef.current!;\n  }, []);\n\n  return (\n    <div className=\"expression-container\">\n      <span className=\"expression-title\">{selectedExpression.name}</span>\n      <span className=\"expression-type\">({selectedExpression.logicType || LogicType.Undefined})</span>\n\n      <div className=\"expression-container-box\" ref={expressionContainerRef}>\n        <LogicTypeSelector\n          selectedExpression={selectedExpression}\n          onLogicTypeUpdating={onLogicTypeUpdating}\n          onLogicTypeResetting={onLogicTypeResetting}\n          onUpdatingNameAndDataType={updateExpressionNameAndDataType}\n          getPlacementRef={getLogicTypeSelectorRef}\n        />\n      </div>\n    </div>\n  );\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport \"@patternfly/react-core/dist/styles/base.css\";\nimport { I18nDictionariesProvider } from \"@kogito-tooling/i18n/dist/react-components\";\nimport { ExpressionContainer, ExpressionContainerProps } from \"../ExpressionContainer\";\nimport {\n  boxedExpressionEditorDictionaries,\n  BoxedExpressionEditorI18nContext,\n  boxedExpressionEditorI18nDefaults,\n} from \"../../i18n\";\n\nexport interface BoxedExpressionEditorProps {\n  /** All expression properties used to define it */\n  expressionDefinition: ExpressionContainerProps;\n}\n\nconst BoxedExpressionEditor: (props: BoxedExpressionEditorProps) => JSX.Element = (\n  props: BoxedExpressionEditorProps\n) => (\n  <I18nDictionariesProvider\n    defaults={boxedExpressionEditorI18nDefaults}\n    dictionaries={boxedExpressionEditorDictionaries}\n    initialLocale={navigator.language}\n    ctx={BoxedExpressionEditorI18nContext}\n  >\n    <ExpressionContainer {...props.expressionDefinition} />\n  </I18nDictionariesProvider>\n);\n\nexport { BoxedExpressionEditor };\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BoxedExpressionEditorI18n } from \"..\";\nimport { en as en_common } from \"@kogito-tooling/i18n-common-dictionary\";\n\nexport const en: BoxedExpressionEditorI18n = {\n  ...en_common,\n  choose: \"Choose...\",\n  clear: \"Clear\",\n  columnOperations: {\n    delete: \"Delete\",\n    insertLeft: \"Insert left\",\n    insertRight: \"Insert right\",\n  },\n  columns: \"COLUMNS\",\n  context: \"Context\",\n  contextEntry: \"CONTEXT ENTRY\",\n  dataType: \"Data Type\",\n  decisionTable: \"Decision Table\",\n  editContextEntry: \"Edit Context Entry\",\n  editExpression: \"Edit Expression\",\n  editRelation: \"Edit Relation\",\n  function: \"Function\",\n  invocation: \"Invocation\",\n  list: \"List\",\n  literalExpression: \"Literal expression\",\n  name: \"Name\",\n  relation: \"Relation\",\n  rowOperations: {\n    delete: \"Delete\",\n    insertAbove: \"Insert above\",\n    insertBelow: \"Insert below\",\n  },\n  rows: \"ROWS\",\n  selectExpression: \"Select expression\",\n  selectLogicType: \"Select logic type\",\n};\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useContext } from \"react\";\nimport { en } from \"./locales\";\nimport { I18nContextType } from \"@kogito-tooling/i18n/dist/react-components\";\nimport { BoxedExpressionEditorI18n } from \"./BoxedExpressionEditorI18n\";\nimport { I18nDefaults, I18nDictionaries } from \"@kogito-tooling/i18n/dist/core\";\n\nexport const boxedExpressionEditorI18nDefaults: I18nDefaults<BoxedExpressionEditorI18n> = {\n  locale: \"en\",\n  dictionary: en,\n};\nexport const boxedExpressionEditorDictionaries: I18nDictionaries<BoxedExpressionEditorI18n> = new Map([[\"en\", en]]);\nexport const BoxedExpressionEditorI18nContext = React.createContext<I18nContextType<BoxedExpressionEditorI18n>>(\n  {} as never\n);\n\nexport function useBoxedExpressionEditorI18n(): I18nContextType<BoxedExpressionEditorI18n> {\n  return useContext(BoxedExpressionEditorI18nContext);\n}\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport { useState } from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport {\n  BoxedExpressionEditor,\n  ContextProps,\n  DataType,\n  ExpressionContainerProps,\n  ExpressionProps,\n  LiteralExpressionProps,\n  RelationProps,\n} from \"./boxed_expression_editor\";\n\nexport const App: React.FunctionComponent = () => {\n  //This definition comes directly from the decision node\n  const selectedExpression = {\n    name: \"Expression Name\",\n    dataType: DataType.Undefined,\n  };\n\n  const [updatedExpression, setUpdatedExpression] = useState(selectedExpression);\n\n  const expressionDefinition: ExpressionContainerProps = { selectedExpression };\n\n  //Defining global function that will be available in the Window namespace and used by the BoxedExpressionEditor component\n  window.beeApi = {\n    resetExpressionDefinition: (definition: ExpressionProps) => setUpdatedExpression(definition),\n    broadcastLiteralExpressionDefinition: (definition: LiteralExpressionProps) => setUpdatedExpression(definition),\n    broadcastRelationExpressionDefinition: (definition: RelationProps) => setUpdatedExpression(definition),\n    broadcastContextExpressionDefinition: (definition: ContextProps) => setUpdatedExpression(definition),\n  };\n\n  return (\n    <div className=\"showcase\">\n      <div className=\"boxed-expression\">\n        <BoxedExpressionEditor expressionDefinition={expressionDefinition} />\n      </div>\n      <div className=\"updated-json\">\n        <p className=\"disclaimer\">\n          ⚠ Currently, JSON gets updated only for literal expression, relation and context logic types\n        </p>\n        <pre>{JSON.stringify(updatedExpression, null, 2)}</pre>\n      </div>\n    </div>\n  );\n};\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from \"./BoxedExpressionEditorI18n\";\nexport * from \"./setup\";\n","/*\n * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport * from \"./BoxedExpressionEditor\";\nexport * from \"./DataType\";\nexport * from \"./ExpressionProps\";\nexport * from \"./LogicType\";\nexport * from \"./Table\";\n"],"sourceRoot":""}